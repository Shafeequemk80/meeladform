<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meelad Form</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body 
  class="d-flex justify-content-center align-items-center min-vh-100" 
  style="background: url('bg.webp') no-repeat center center/cover;">
  
  <div class="card shadow p-4 rounded-3 col-12 col-md-8 col-lg-6 mx-auto bg-white ">
    <h2 class="mb-4 text-center text-primary">Meelad Form</h2>

    <form id="contact-form" class="needs-validation" novalidate>
      
      <div class="mb-3">
        <label class="form-label">Full Name</label>
        <input type="text" name="FullName" class="form-control" placeholder="Enter full name" pattern="^[a-zA-Z ]{3,}$" required>
        <div class="invalid-feedback"> Enter a valid full name</div>
      </div>

      <div class="mb-3">
        <label class="form-label">Mobile Number</label>
        <input type="tel" name="MobileNumber" class="form-control" 
               placeholder=" Enter mobile number" 
               pattern="^[0-9]{8,10}$" required>
        <div class="invalid-feedback">Enter  a valid mobile number</div>
      </div>

      <div class="mb-3">
        <label class="form-label">Profession</label>
       <select name="Profession" class="form-select" required>
  <option value="">Select Profession</option>
</select>
        <div class="invalid-feedback"> Select a valid profession.</div>
      </div>

      <div class="mb-3">
        <label class="form-label">Place</label>
        <input type="text" name="Place" class="form-control" placeholder="Enter your place" pattern="^[a-zA-Z0-9 ,.-]{2,}$" required>
        <div class="invalid-feedback">Please enter a valid place.</div>
      </div>

      <!-- hidden inputs required by script -->
      <input type="hidden" name="formGoogleSheetName" value="responses">
      <input type="hidden" name="formGoogleSendEmail" value="your@email.com">

      <button type="submit" class="btn btn-primary w-100" id="submitBtn">
        Submit
      </button>
    </form>

    <div id="msg" class="mt-3"></div>
  </div>


  <script src="/script.js"></script>
  
<script>
document.addEventListener("DOMContentLoaded", function () {
  const form = document.getElementById("contact-form");
  const submitBtn = document.getElementById("submitBtn");

  form.addEventListener("submit", function (event) {
    event.preventDefault();
    event.stopPropagation();

    if (!form.checkValidity()) {
      form.classList.add("was-validated");
      return;
    }

    // Show loading state
    submitBtn.disabled = true;
    submitBtn.innerHTML = `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Submitting...`;

    const scriptURL = "https://script.google.com/macros/s/AKfycbx44E77WoFOpzPoQhm_ZXMbje5cyAyg6hm-DTsO_JmQfY5xSOJYPpK5rf8cJSoc7_ZB/exec";

    fetch(scriptURL, {
      method: "POST",
      body: new FormData(form),
    })
      .then((response) => {
        if (response.ok) {
          Swal.fire({
            icon: "success",
            title: "Success!",
            text: "Your attendance is marked",
            confirmButtonColor: "#3085d6"
          });
          form.reset();
          form.classList.remove("was-validated");
        } else {
          throw new Error("Form submission failed");
        }
      })
      .catch(() => {
        Swal.fire({
          icon: "error",
          title: "Oops...",
          text: "Something went wrong! Please try again.",
        });
      })
      .finally(() => {
        submitBtn.disabled = false;
        submitBtn.innerHTML = "Submit";
      });
  });
});
</script>
</body>
</html>
